Based on code from [Paul Saxman's](https://github.com/saxman) [Genscai](https://github.com/saxman/genscai) repository.